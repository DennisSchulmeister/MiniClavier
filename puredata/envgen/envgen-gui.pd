#N struct egg_breakpoint float x float y float enabled float selected
float value float duration float starttime;
#N struct egg_state array start egg_breakpoint array end egg_breakpoint
;
#N struct egg_main float y array start egg_breakpoint array end egg_breakpoint
;
#N canvas 0 49 1920 1009 12;
#X abframe 1;
#N canvas 0 49 1920 1009 12;
#X obj 300 180 inlet;
#X text 20 10 Recalculation of all transient breakpoint values after
a change of the underlying data. Updates the following fields: *
x based on "view ms" and GOP width* y based on GOP height* starttime
as sum of previous durations Send a bang to the inlet to trigger
the recalculation.;
#X abpush recalc-breakpoints;
#N canvas 0 49 1920 1009 12;
#X text 20 20 Send current values to the controlled [envgen~] object.
Befor this the [Ã¦b recalc-breakpoints] should have been called to
update the breakpoint arrays. Send a bang to the inlet to trigger
the sending.;
#X obj 200 180 inlet;
#X abpush send-values;
#X abframe 0;
#X obj 700 289 cnv 15 300 60 empty empty empty 20 12 0 14 #e2eaf4 #404040
0;
#X obj 700 100 cnv 15 300 40 empty \$0-label empty 10 17 0 12 #e0e0e0
#404040 0;
#X obj -30 -30 preset_hub k12 1 %hidden%;
#N canvas 0 49 1920 1009 init 0;
#X msg 230 250 clear;
#X obj 200 389 pointer;
#X obj 200 220 trigger b b;
#X text 210 340 ---- Create state instance ----;
#X obj 460 650 r \$0-state-pointer;
#X obj 470 1170 r \$0-state-pointer;
#X obj 200 1690 s \$0-init-done;
#X obj 200 420 trigger b p, f 24;
#X obj 630 280 value \$0_default_length;
#X obj 200 450 v \$0_default_length;
#X msg 820 250 4;
#X obj 820 280 value \$0_default_start_bps;
#X msg 1030 250 2;
#X obj 1030 280 value \$0_default_end_bps;
#X obj 290 620 value \$0_default_start_bps;
#X obj 290 1170 value \$0_default_end_bps;
#X obj 290 510 s \$0-state-pointer;
#X obj 200 590 trigger b b b;
#X text 210 1670 ---- Announce end of initialization ----;
#X obj 370 250 symbol \$1;
#X msg 370 280 \; \$0-label label \$1;
#X text 210 200 ---- Clear data \, initialize variables \, set canvas
label ----;
#X msg 530 280 \; \$0-length \$1;
#X obj 200 150 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000 1;
#X obj 200 510 trigger b p;
#X text 210 570 ---- Create pre-defined start breakpoints ----;
#X text 210 1120 ---- Create pre-defined end breakpoints ----;
#X text 350 1290 Pre-defined end breakpoints (first value must match
last start breakpoint), f 78;
#X msg 530 250 3000;
#X obj 510 830 r \$0-state-pointer;
#X obj 230 680 trigger b b;
#X obj 230 710 trigger b b b b;
#X obj 250 770 trigger l b;
#X text 650 830 Output: breakpoint pointer;
#X obj 340 859 s \$0-breakpoint-pointer;
#X obj 340 800 f;
#X obj 380 800 + 1;
#X obj 490 1070 r \$0-breakpoint-pointer;
#X floatatom 420 800 5 0 0 1 Array_Index - - 0 0 1, f 5;
#X msg 340 770 -1;
#X msg 1230 250 0;
#X obj 1230 279 value \$0_x;
#X obj 430 950 value \$0_x;
#X obj 410 980 +;
#X obj 410 1010 trigger f f;
#X obj 360 920 trigger f f b;
#X text 380 480 Output: egg_state pointer;
#X obj 200 480 append egg_state length, f 24;
#X obj 290 650 setsize egg_state start;
#X obj 340 830 element egg_state start;
#X obj 290 1200 setsize egg_state end;
#X obj 230 280 send pd-egg-data;
#X msg 200 360 traverse pd-egg-data \, bang;
#X text 530 740 Pre-defined start breakpoints (enabled \, value \,
duration);
#X msg 440 740 1 0.8 1000;
#X msg 350 740 1 0.8 400;
#X msg 280 740 1 1 200;
#X msg 230 740 0 0 0;
#X msg 280 1290 1 0 800;
#X obj 250 890 unpack f f f;
#X obj 250 1070 set egg_breakpoint enabled y d x;
#X floatatom 590 1040 5 0 0 0 - - - 0 0 1, f 5;
#X obj 510 1040 value \$0_x;
#X obj 490 1380 r \$0-state-pointer;
#X obj 240 1320 trigger l b;
#X text 630 1380 Output: breakpoint pointer;
#X obj 330 1409 s \$0-breakpoint-pointer;
#X obj 330 1350 f;
#X obj 370 1350 + 1;
#X obj 480 1620 r \$0-breakpoint-pointer;
#X floatatom 410 1350 5 0 0 1 Array_Index - - 0 0 1, f 5;
#X msg 330 1320 -1;
#X obj 420 1500 value \$0_x;
#X obj 400 1530 +;
#X obj 400 1560 trigger f f;
#X obj 350 1470 trigger f f b;
#X obj 240 1440 unpack f f f;
#X obj 240 1620 set egg_breakpoint enabled y d x;
#X floatatom 580 1590 5 0 0 0 - - - 0 0 1, f 5;
#X obj 500 1590 value \$0_x;
#X obj 200 1140 trigger b b b;
#X obj 220 1260 trigger b b;
#X obj 330 1380 element egg_state end;
#X obj 220 1230 trigger b b;
#X msg 220 1290 0 0.8 0;
#X text 300 80 TODO: Redo;
#X obj 200 120 inlet;
#X connect 0 0 51 0;
#X connect 1 0 7 0;
#X connect 2 0 52 0;
#X connect 2 1 28 0;
#X connect 2 1 10 0;
#X connect 2 1 12 0;
#X connect 2 1 19 0;
#X connect 2 1 40 0;
#X connect 2 1 0 0;
#X connect 4 0 48 1;
#X connect 5 0 50 1;
#X connect 7 0 9 0;
#X connect 7 1 47 1;
#X connect 9 0 47 0;
#X connect 10 0 11 0;
#X connect 12 0 13 0;
#X connect 14 0 48 0;
#X connect 15 0 50 0;
#X connect 17 0 80 0;
#X connect 17 1 30 0;
#X connect 17 2 14 0;
#X connect 19 0 20 0;
#X connect 24 0 17 0;
#X connect 24 1 16 0;
#X connect 28 0 8 0;
#X connect 28 0 22 0;
#X connect 29 0 49 1;
#X connect 30 0 31 0;
#X connect 30 1 39 0;
#X connect 31 0 54 0;
#X connect 31 1 55 0;
#X connect 31 2 56 0;
#X connect 31 3 57 0;
#X connect 32 0 59 0;
#X connect 32 1 35 0;
#X connect 35 0 36 0;
#X connect 35 0 38 0;
#X connect 35 0 49 0;
#X connect 36 0 35 1;
#X connect 37 0 60 4;
#X connect 39 0 35 0;
#X connect 40 0 41 0;
#X connect 42 0 43 1;
#X connect 43 0 44 0;
#X connect 44 0 60 3;
#X connect 44 1 61 0;
#X connect 44 1 62 0;
#X connect 45 0 60 2;
#X connect 45 1 43 0;
#X connect 45 2 42 0;
#X connect 47 0 24 0;
#X connect 49 0 34 0;
#X connect 52 0 1 0;
#X connect 54 0 32 0;
#X connect 55 0 32 0;
#X connect 56 0 32 0;
#X connect 57 0 32 0;
#X connect 58 0 64 0;
#X connect 59 0 60 0;
#X connect 59 1 60 1;
#X connect 59 2 45 0;
#X connect 63 0 82 1;
#X connect 64 0 76 0;
#X connect 64 1 67 0;
#X connect 67 0 68 0;
#X connect 67 0 70 0;
#X connect 67 0 82 0;
#X connect 68 0 67 1;
#X connect 69 0 77 4;
#X connect 71 0 67 0;
#X connect 72 0 73 1;
#X connect 73 0 74 0;
#X connect 74 0 77 3;
#X connect 74 1 78 0;
#X connect 74 1 79 0;
#X connect 75 0 77 2;
#X connect 75 1 73 0;
#X connect 75 2 72 0;
#X connect 76 0 77 0;
#X connect 76 1 77 1;
#X connect 76 2 75 0;
#X connect 80 0 6 0;
#X connect 80 1 83 0;
#X connect 80 2 15 0;
#X connect 81 0 58 0;
#X connect 81 1 84 0;
#X connect 82 0 66 0;
#X connect 83 0 81 0;
#X connect 83 1 71 0;
#X connect 84 0 64 0;
#X connect 86 0 23 0;
#X restore 1200 420 pd init;
#X floatatom 940 110 5 0 0 0 View - - 0 0 0, f 5;
#X msg 940 60 set \$1;
#N canvas 0 49 1920 1009 struct-egg_breakpoint 0;
#X obj 100 280 filledpolygon -v enabled 111 111 1 -3 -3 -3 3 3 3 3
-3;
#X obj 100 180 struct egg_breakpoint float x float y float enabled
float selected float value float duration float starttime, f 110;
#X text 100 50 x \, yenabledselectedvaluedurationstarttime;
#X text 170 50 = UI coordinates within GOP= Breakpoint can be changed=
Breakpoint is visible in the UI fields= Envelope target value= Duration
to reach value [ms]= Sum of previous durations (for UI calculations)
;
#X obj 100 340 drawnumber -v enabled value -5 -30 555 v:;
#X obj 100 370 drawnumber -v enabled duration -5 -20 555 d:;
#X obj 100 310 filledpolygon -v selected 600 600 1 -5 -5 -5 5 5 5 5
-5;
#X restore 1210 390 pd struct-egg_breakpoint;
#N canvas 0 49 1920 1009 egg-data 0;
#X scalar egg_state \; 0 0 0 0 0 0 0 \; 0 200 1 1 0 0 0 \; 0 0 600
0.8 1 0 0 \; 0 0 0 1600 0.8 1 0 \; \; 1600 0.8 0 0 0 0 0 \; 0 2400
0 1 0 0 0 \; \;;
#X coords 0 -1 1 1 300 140 2 0 0;
#X restore 700 140 pd egg-data;
#X msg 1360 221 300;
#X obj 1230 249 value \$0_plot_dx;
#X obj 1360 250 value \$0_plot_dy;
#X obj 700 280 hradio 15 0 0 20 \$0-ui-radios-out empty empty 0 -8
0 10 #fcfcfc #000000 #000000 0 1;
#X floatatom 870 306 5 0 0 3 Value - #0-ui-value 0 0 1, f 5;
#X floatatom 930 306 5 0 0 3 Duration - #0-ui-duration 0 0 1, f 5
;
#X obj 830 380 r \$0-ui-value;
#X msg 830 410 set \$1;
#X obj 960 380 r \$0-ui-duration;
#X msg 960 409 set \$1;
#X obj 940 30 r \$0-ui-view;
#N canvas 0 49 1920 1009 on-ui-view-changed 0;
#X obj 200 180 r \$0-length;
#X text 410 180 TODO: Update length in state;
#X text 410 210 TODO: Move last point of start array;
#X text 410 240 TODO: Move all points in end array;
#X restore 1200 510 pd on-ui-view-changed;
#N canvas 0 49 1920 1009 on-ui-interaction 0;
#X restore 1200 540 pd on-ui-interaction;
#X obj 980 550 ab recalc-breakpoints;
#X obj 710 306 bng 15 250 50 0 \$0-ui-add-button empty Add 20 6 0 12
#fcfcfc #9b5050 #000000 1;
#X obj 770 306 bng 15 250 50 0 \$0-ui-remove-breakpoint empty Remove
20 6 0 12 #fcfcfc #9b5050 #000000 1;
#X text 970 306 ms;
#X text 980 110 ms;
#X obj 550 250 r \$0-ui-radios-in;
#X msg 1560 230 20;
#X obj 1560 259 value \$0_max_breakpoints;
#X text 1560 281 Limited by the width of the hradios;
#X text 1230 280 Must match the GOP size of the array plots;
#X obj 980 580 ab send-values;
#N canvas 0 49 1920 1009 on-values-received 0;
#X text 20 20 Update the breakpoints when new values are sent to the
[envgen~] object from someone else. This establishes a two-way binding
between UI and [envgen~] where the UI will follow when the [envgen~]
receives new values from somewhere else., f 72;
#X restore 1200 480 pd on-values-received;
#X text 10 10 User Interface for the [envgen~] envelope generator===================================================
Provides a GUI to visualy edit the envelope breakpoints. Communication
with the [envgen~] is two-way with two distinct send/receive pairs.
This allows to program the envelope generator from the GUI \, but also
to update the GUI when the envelope generator recieves messages from
other sources \, too. Creation arguments: \$1 symbol: Label\$2
symbol: Name of the generator's receiver: [r ...]-->[envgen~]\$3 symbol:
Name of the generator's echo sender: [envgen~]-->[s ...], f 70;
#N canvas 0 49 1920 1009 struct-egg_main 0;
#X text 100 60 Main structure of the envelope generator gui. This is
the only scalar on the top-level of the egg-gui sub-patch.;
#X obj 100 180 struct egg_main float y array start egg_breakpoint array
end egg_breakpoint, f 76;
#X obj 100 250 plot start 500 2 0 y;
#X obj 100 280 plot end 5 2 0 y;
#X restore 1210 360 pd struct-egg_main;
#X msg 1230 220 160;
#X obj 1200 80 loadbang;
#X obj 1200 190 trigger b b;
#X text 1210 170 ---- Set global variables ----;
#X text 1210 330 ---- Initialize data structures ----;
#X obj 1200 110 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000 1;
#X connect 5 0 4 0;
#X connect 8 0 10 0;
#X connect 14 0 15 0;
#X connect 15 0 12 0;
#X connect 16 0 17 0;
#X connect 17 0 13 0;
#X connect 18 0 5 0;
#X connect 26 0 11 0;
#X connect 27 0 28 0;
#X connect 35 0 9 0;
#X connect 36 0 40 0;
#X connect 37 0 3 0;
#X connect 37 1 35 0;
#X connect 37 1 8 0;
#X connect 37 1 27 0;
#X connect 40 0 37 0;
#X coords 0 -1 1 1 300 250 2 700 100;
