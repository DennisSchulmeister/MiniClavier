#N struct egui__main float dy float view array attack egui__breakpoint
array release egui__breakpoint;
#N struct egui__breakpoint float x float y float enabled float selected
float value float duration float starttime;
#N canvas 0 49 1920 1009 12;
#X obj 700 289 cnv 15 300 60 empty empty empty 20 12 0 14 #e2eaf4 #404040
0;
#X obj 700 100 cnv 15 300 40 empty \$0-ui-label empty 10 17 0 12 #e0e0e0
#404040 0;
#X obj -30 -30 preset_hub k12 1 %hidden%;
#X floatatom 940 110 5 0 0 0 View - #0-ui-view 0 0 1, f 5;
#X msg 940 60 set \$1;
#X obj 700 280 hradio 15 0 0 20 \$0-ui-radios-out empty empty 0 -8
0 10 #fcfcfc #000000 #000000 0 1;
#X floatatom 870 306 5 0 0 3 Value - #0-ui-value 0 0 1, f 5;
#X floatatom 930 306 5 0 0 3 Duration - #0-ui-duration 0 0 1, f 5
;
#X obj 830 380 r \$0-ui-value;
#X msg 830 410 set \$1;
#X obj 960 380 r \$0-ui-duration;
#X msg 960 409 set \$1;
#X obj 940 30 r \$0-ui-view;
#X obj 710 306 bng 15 250 50 0 \$0-ui-add-button empty Add 20 6 0 12
#fcfcfc #9b5050 #000000 1;
#X obj 770 306 bng 15 250 50 0 \$0-ui-remove-breakpoint empty Remove
20 6 0 12 #fcfcfc #9b5050 #000000 1;
#X text 970 306 ms;
#X text 980 110 ms;
#X obj 550 250 r \$0-ui-radios-in;
#X msg 1690 320 20;
#X text 1690 380 Limited by the width of the hradios;
#X text 1230 380 Must match the GOP size of the array plots;
#X obj 1200 180 loadbang;
#X obj 1200 290 trigger b b;
#X text 1210 270 ---- Set global variables ----;
#X text 1210 600 ---- Initialize data structures ----;
#X obj 1200 210 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000 1;
#X obj 0 0 cnv 15 500 30 empty empty User\ Interface\ for\ the\ [envgen~]\ envelope\ generator
10 12 0 14 #e0e0e0 #404040 0;
#X obj 0 140 cnv 15 500 15 empty empty Creation\ Arguments 10 5 0 12
#e0e0e0 #404040 0;
#X text 10 160 \$1 symbol: Label, f 68;
#X text 10 180 \$2 symbol: Name of the generator's receiver: [r ...]-->[envgen~]
, f 68;
#X text 10 200 \$3 symbol: Name of the generator's echo sender: [envgen~]-->[s
...], f 68;
#X text 10 40 Provides a GUI to visualy edit the envelope breakpoints.
Communication with the [envgen~] is two-way with two distinct send/receive
pairs. This allows to program the envelope generator from the GUI \,
but also to update the GUI when the envelope generator recieves messages
from other sources., f 68;
#X text 900 640 TODO:;
#X obj 0 230 cnv 15 500 15 empty empty Isolation\ from\ other\ patches
10 5 0 12 #e0e0e0 #404040 0;
#X text 10 260 This abstraction should be fairly well isolated from
the pure data environment. We use a egui__ prefix for sub-patches and
struct templates. Normaly name clashes shouldn't be a problem. To be
sure \, avoid the egui__ prefix to not mess-up the envelope generator
UI., f 68;
#N canvas 0 49 1920 1009 egui__struct_main 0;
#X text 10 10 Main structure of the envelope generator gui. This is
the only scalar on the top-level of the egui__ui sub-patch., f 69
;
#X text 10 80 - view;
#X text 10 100 - attack;
#X text 10 120 - release;
#X text 90 120 = Release breackpoints, f 58;
#X text 90 100 = Attack breackpoints, f 58;
#X text 90 80 = View window in ms, f 58;
#X text 90 60 = Y offset to move the plots to the bottom, f 58;
#X obj 100 200 struct egui__main float dy float view array attack egui__breakpoint
array release egui__breakpoint, f 98;
#X text 10 60 - dy;
#X obj 100 300 filledpolygon 222 222 1 0 0 300 0 300 140 0 140;
#X obj 100 330 plot attack 500 2 0 dy;
#X obj 100 360 plot release 5 2 0 dy;
#X obj 100 420 drawnumber view 10 200 5 View:;
#X obj 100 450 drawnumber dy 10 220 5 y:;
#X restore 1200 100 pd egui__struct_main;
#N canvas 0 49 1920 1009 egui__struct_breakpoint 0;
#X text 10 10 Structure for a single breakpoint (raw data and ui);
#X text 100 40 = UI coordinates within GOP;
#X text 100 60 = Breakpoint can be changed;
#X text 100 80 = Breakpoint is visible in the UI fields;
#X text 100 100 = Envelope target value;
#X text 100 120 = Duration to reach value [ms];
#X text 100 140 = Sum of previous durations (for UI calculations);
#X text 10 40 - x \, y;
#X text 10 60 - enabled;
#X text 10 80 - selected;
#X text 10 100 - value;
#X text 10 120 - duration;
#X text 10 140 - starttime;
#X obj 100 200 struct egui__breakpoint float x float y float enabled
float selected float value float duration float starttime, f 114;
#X obj 100 300 filledpolygon -v enabled 555 555 1 -3 -3 -3 3 3 3 3
-3;
#X obj 100 330 filledpolygon -v selected 600 600 1 -5 -5 -5 5 5 5 5
-5;
#X obj 100 360 drawnumber -v enabled value -5 -30 666 v:;
#X obj 100 390 drawnumber -v enabled duration -5 -20 666 d:;
#X restore 1200 130 pd egui__struct_breakpoint;
#N canvas 0 49 1920 1009 egui__init 0;
#X msg 130 230 clear;
#X obj 100 369 pointer;
#X obj 100 200 trigger b b;
#X obj 100 960 s \$0-init-done;
#X obj 100 400 trigger b p, f 24;
#X text 110 940 ---- Announce end of initialization ----;
#X obj 100 130 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000 1;
#X obj 100 100 inlet;
#X text 10 10 Initialization of the main structure;
#X text 110 320 ---- Create main instance ----;
#X text 280 460 Output: main pointer;
#X obj 130 260 send pd-egui__ui;
#X msg 100 340 traverse pd-egui__ui \, bang;
#X text 110 180 ---- Clear data ----;
#X text 110 840 ---- Initialiaze UI widgets ----;
#X obj 130 890 ./egui-refresh-breakpoint-ui;
#X obj 100 860 trigger b b;
#X obj 130 630 set egui__main view, f 22;
#X obj 190 570 r \$0-ui-view;
#X obj 130 599 f;
#X obj 160 760 setsize egui__main attack;
#X obj 100 490 trigger b p;
#X obj 130 520 s \$0-init-main-pointer;
#X obj 300 600 r \$0-init-main-pointer;
#X obj 360 730 r \$0-init-main-pointer;
#X obj 100 570 trigger b b;
#X text 110 680 ---- Create breakpoint arrays ----;
#X msg 140 730 2;
#X obj 100 700 trigger b b;
#X obj 140 790 setsize egui__main release;
#X obj 100 430 value _\$0_plot_dy;
#X obj 100 460 append egui__main dy, f 24;
#X connect 0 0 11 0;
#X connect 1 0 4 0;
#X connect 2 0 12 0;
#X connect 2 1 0 0;
#X connect 4 0 30 0;
#X connect 4 1 31 1;
#X connect 6 0 2 0;
#X connect 7 0 6 0;
#X connect 12 0 1 0;
#X connect 16 0 3 0;
#X connect 16 1 15 0;
#X connect 18 0 19 0;
#X connect 19 0 17 0;
#X connect 21 0 25 0;
#X connect 21 1 22 0;
#X connect 23 0 17 1;
#X connect 24 0 20 1;
#X connect 24 0 29 1;
#X connect 25 0 28 0;
#X connect 25 1 19 0;
#X connect 27 0 20 0;
#X connect 27 0 29 0;
#X connect 28 0 16 0;
#X connect 28 1 27 0;
#X connect 30 0 31 0;
#X connect 31 0 21 0;
#X restore 1200 620 pd egui__init;
#N canvas 0 49 1920 1009 egui__handle_external_parameter_change 1;
#X text 20 20 Update the breakpoints when new values are sent to the
[envgen~] object from someone else. This establishes a two-way binding
between UI and [envgen~] where the UI will follow when the [envgen~]
receives new values from somewhere else., f 72;
#X obj 100 120 inlet;
#X obj 100 170 route symbol, f 19;
#X obj 100 200 list trim 1;
#X obj 100 230 route list;
#X obj 150 670 route attack release;
#X obj 130 630 route set;
#X obj 100 260 trigger a;
#X obj 170 950 unpack f f;
#X obj 150 920 ./foreach-list-split 2;
#X text 110 310 ---- Get main instance ----;
#X obj 140 390 pointer;
#X text 200 390 Output: main pointer;
#X msg 140 360 traverse pd-egui__ui \, next;
#X obj 140 420 s \$0-parchg-main-pointer;
#X obj 100 330 trigger a b;
#X text 110 1230 ----- Redraw breakpoints ----;
#X obj 100 1280 ./egui-recalc-breakpoints;
#X obj 100 600 trigger b a;
#X text 110 470 ---- Handle received message ----;
#X obj 100 1250 spigot;
#X obj 160 1250 r \$0-parchg-redraw;
#X obj 100 490 trigger a b;
#X msg 130 520 0;
#X obj 130 550 s \$0-parchg-redraw;
#X obj 420 820 trigger a;
#X obj 170 820 trigger a;
#X obj 210 790 setsize egui__main attack;
#X obj 210 730 list length;
#X obj 210 759 expr imodf($f1 / 2);
#X text 600 760 Number of breakpoints = rounded down list length /
2;
#X obj 170 700 trigger a a;
#X obj 420 700 trigger a a;
#X obj 450 731 list length;
#X obj 450 760 expr imodf($f1 / 2);
#X obj 450 791 setsize egui__main release;
#X text 160 650 ---- Resize selected breakpoint array ----;
#X obj 150 850 trigger a;
#X text 160 900 ---- Initialize breakpoint instances ----;
#X text 170 980 TODO;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 2 1 4 0;
#X connect 3 0 4 0;
#X connect 4 1 7 0;
#X connect 5 0 31 0;
#X connect 5 1 32 0;
#X connect 6 0 5 0;
#X connect 7 0 15 0;
#X connect 9 0 8 0;
#X connect 11 0 14 0;
#X connect 13 0 11 0;
#X connect 15 0 22 0;
#X connect 15 1 13 0;
#X connect 18 0 20 0;
#X connect 18 1 6 0;
#X connect 20 0 17 0;
#X connect 21 0 20 1;
#X connect 22 0 18 0;
#X connect 22 1 23 0;
#X connect 23 0 24 0;
#X connect 25 0 37 0;
#X connect 26 0 37 0;
#X connect 28 0 29 0;
#X connect 29 0 27 0;
#X connect 31 0 26 0;
#X connect 31 1 28 0;
#X connect 32 0 25 0;
#X connect 32 1 33 0;
#X connect 33 0 34 0;
#X connect 34 0 35 0;
#X connect 37 0 9 0;
#X restore 1200 670 pd egui__handle_external_parameter_change;
#N canvas 0 49 1920 1009 egui__handle_ui_view_change 0;
#X text 10 10 Handle new value in the "field" number box (view window)
;
#X obj 100 100 r \$0-ui-view;
#X obj 170 270 pointer;
#X text 230 270 Output: main pointer;
#X msg 170 240 traverse pd-egui__ui \, next;
#X obj 130 200 trigger f b;
#X text 110 150 ---- Update main.view field ----;
#X obj 130 310 set egui__main view;
#X obj 100 170 trigger b f;
#X text 110 360 ---- Redraw breakpoints ----;
#X obj 100 380 ./egui-recalc-breakpoints;
#X connect 1 0 8 0;
#X connect 2 0 7 1;
#X connect 4 0 2 0;
#X connect 5 0 7 0;
#X connect 5 1 4 0;
#X connect 8 0 10 0;
#X connect 8 1 5 0;
#X restore 1200 700 pd egui__handle_ui_view_change;
#N canvas 0 49 1920 1009 egui__handle_ui_interaction 0;
#X restore 1200 730 pd egui__handle_ui_interaction;
#X text 1550 670 TODO: Recreate breakpoints \, recalc \, update UIs
;
#X obj 900 670 ./egui-recalc-breakpoints;
#X obj 900 700 ./egui-send-values;
#X obj 900 730 ./egui-refresh-breakpoint-ui;
#X obj 1200 460 trigger b b;
#X msg 1240 500 3000;
#X obj 1350 500 symbol \$1;
#X obj 1240 529 s \$0-ui-view;
#X text 1210 440 ---- Initialize UI header ----;
#X msg 1350 530 \; \$0-ui-label label \$1;
#N canvas 0 49 1920 1009 egui__handle_plot_interaction 0;
#X restore 1200 760 pd egui__handle_plot_interaction;
#X text 1550 760 TODO: Recalc? \, update UIs \, send values;
#X text 1550 730 TODO: Struct mutations \, recalc \, send values;
#N canvas 0 49 1920 1009 egui__ui 0;
#X scalar egui__main 160 3000 \; 0 0 0 0 0 0 0 \; 0 0 0 0 0 0 0 \;
\; 0 0 0 0 0 0 0 \; 0 0 0 0 0 0 0 \; \;;
#X coords 0 0 300 140 300 140 2 0 0;
#X restore 700 140 pd egui__ui;
#X msg 1230 320 300;
#X msg 1360 320 160;
#X obj 1230 350 value _\$0_plot_dx;
#X obj 1360 350 value _\$0_plot_dy;
#X obj 1690 350 value _\$0_max_breakpoints;
#X msg 1490 320 20;
#X obj 1490 349 value _\$0_plot_padding_top;
#X obj 900 760 ./egui-foreach-breakpoint;
#X connect 4 0 3 0;
#X connect 8 0 9 0;
#X connect 9 0 6 0;
#X connect 10 0 11 0;
#X connect 11 0 7 0;
#X connect 12 0 4 0;
#X connect 17 0 5 0;
#X connect 18 0 59 0;
#X connect 21 0 25 0;
#X connect 22 0 45 0;
#X connect 22 1 55 0;
#X connect 22 1 56 0;
#X connect 22 1 18 0;
#X connect 25 0 22 0;
#X connect 45 0 37 0;
#X connect 45 1 46 0;
#X connect 45 1 47 0;
#X connect 46 0 48 0;
#X connect 47 0 50 0;
#X connect 55 0 57 0;
#X connect 56 0 58 0;
#X connect 60 0 61 0;
#X coords 0 -1 1 1 300 250 2 700 100;
