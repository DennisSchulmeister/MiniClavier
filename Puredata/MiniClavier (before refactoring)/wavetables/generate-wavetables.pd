#N canvas 0 49 1920 1009 12;
#X obj -30 -30 preset_hub k12 1 %hidden%;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable1 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 700 100 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable2 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 910 100 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable3 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1120 100 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable4 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1330 100 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable5 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 700 310 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable6 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 910 310 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable7 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1120 310 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable8 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1330 310 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable9 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 700 520 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable10 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 910 520 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable11 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1120 520 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable12 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1330 520 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable13 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 700 730 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable14 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 910 730 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable15 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1120 730 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array wavetable16 515 float 0 black black;
#X coords 0 1 514 -1 200 200 1;
#X restore 1330 730 graph;
#N canvas 0 49 1920 1009 ui 0;
#X floatatom 420 230 5 0 0 0 - - #0-octaves 0 0 1, f 5;
#X obj 310 230 vradio 20 0 0 4 \$0-waveform empty empty 0 -8 0 10 #fcfcfc
#000000 #000000 0 1;
#X text 340 270 Square;
#X text 340 290 Triangle;
#X text 310 210 Waveform;
#X text 420 210 Octaves/Wavetable;
#X obj 310 140 r \$0-waveform;
#X msg 310 169 set \$1;
#X obj 420 140 r \$0-octaves;
#X msg 420 169 set \$1;
#X text 570 210 Wavetable;
#X floatatom 570 230 5 0 0 0 - - #0-wavetable 0 0 1, f 5;
#X obj 620 141 r \$0-wavetable;
#X msg 620 170 set \$1;
#X obj 570 290 bng 20 250 50 0 \$0-wavetable-clear empty Clear 22 8
0 12 #fcfcfc #000000 #000000 1;
#X obj 570 320 bng 20 250 50 0 \$0-wavetable-load empty Load\ File
22 8 0 12 #fcfcfc #000000 #000000 1;
#X obj 570 350 bng 20 250 50 0 \$0-wavetable-save empty Save\ File
22 8 0 12 #fcfcfc #000000 #000000 1;
#X obj 1300 211 loadbang;
#X obj 1300 240 bng 15 250 50 0 empty empty empty 17 7 0 10 #fcfcfc
#000000 #000000 1;
#X obj 310 350 bng 20 250 50 0 \$0-clear-all empty Clear\ All 22 8
0 12 #fcfcfc #000000 #000000 1;
#X obj 570 260 bng 20 250 50 0 \$0-wavetable-calc empty Calculate 22
8 0 12 #fcfcfc #000000 #000000 1;
#X text 420 260 Samples/Wavetable;
#X floatatom 420 280 5 0 0 0 - - #0-samples 0 0 1, f 5;
#X msg 520 170 set \$1;
#X obj 310 320 bng 20 250 50 0 \$0-calc-all empty Calculate\ All 22
8 0 12 #fcfcfc #000000 #000000 1;
#X obj 520 141 r \$0-samples;
#N canvas 0 49 1920 1009 calc-wavetable 0;
#X obj 100 80 r \$0-wavetable-calc;
#X obj 130 430 mtof;
#X obj 130 490 value _\$0_wtc_base_frequency;
#X obj 130 180 samplerate~;
#X obj 130 210 expr \\$f1 / 2;
#X obj 130 270 value _\$0_wtc_nyquist_frequency;
#X obj 130 590 expr ceil(_\$0_wtc_nyquist_frequency / _\$0_wtc_base_frequency)
, f 62;
#X obj 130 650 value _\$0_wtc_n_harmonics;
#X obj 100 150 trigger b b;
#X obj 100 340 trigger b b;
#X obj 100 560 trigger b b;
#X floatatom 130 240 5 0 0 0 - - - 0 0 1, f 5;
#X floatatom 130 400 5 0 0 0 - - - 0 0 1, f 5;
#X floatatom 130 460 5 0 0 0 - - - 0 0 1, f 5;
#X floatatom 130 620 5 0 0 0 - - - 0 0 1, f 5;
#X obj 100 950 value _\$0_wtc_n_harmonics;
#X obj 100 980 until;
#X obj 100 1010 f;
#X obj 140 1010 + 1;
#X msg 180 1010 1;
#X obj 100 920 trigger b b;
#X text 110 130 ---- Calculate maximum allowed frequency ----;
#X text 110 320 ---- Calculate frequency of the 1st harmonic ----;
#X text 110 540 ---- Calculate number of harmonics without aliasing
----;
#X text 110 700 ---- Calculate harmonic amplitudes for the selected
waveform ----, f 66;
#X text 110 1520 ---- Synthesize waveform ----;
#X obj 130 1140 value _\$0_waveform;
#X obj 160 1090 value _\$0_wtc_harmonic;
#X obj 130 1060 trigger b f;
#X text 1100 1200 Harmonic amplitudes, f 75;
#X text 1100 1220 ===================, f 75;
#X text 1100 1310 Square.....: Odd harmonics \, 1/n amplitude \, all
harmonics in phase, f 75;
#X text 1100 1340 Triangle...: Odd harmonics \, 1/n² amplitude \,
every second 180° out of phase, f 75;
#X obj 190 1230 expr (1 / _\$0_wtc_harmonic) * pow(-1 \, _\$0_wtc_harmonic)
* -1, f 97;
#X obj 270 780 value _\$0_wavetable;
#X obj 130 780 value _\$0_waveform;
#X obj 420 780 value _\$0_wtc_nyquist_frequency;
#X obj 650 780 value _\$0_wtc_base_frequency;
#X obj 860 780 value _\$0_wtc_n_harmonics;
#X obj 130 750 trigger b b b b b;
#X obj 130 810 pack f f f f f;
#X obj 100 720 trigger b b;
#X obj 130 840 print Calculate wavetable: waveform wavevable nyquist-f
base-f n-harmonics, f 76;
#X text 880 1230 Sawtooth;
#X text 1100 1280 Sawtooth...: All harmonics \, 1/n amplitude \, even
harmonics 180° out of phase, f 75;
#X obj 160 1260 expr if(_\$0_wtc_harmonic % 2 != 0 \, 1 / _\$0_wtc_harmonic
\, 0), f 101;
#X text 880 1260 Square;
#X text 880 1290 Triangle;
#X obj 130 1290 expr if(_\$0_wtc_harmonic % 2 != 0 \, 1 / pow(_\$0_wtc_harmonic
\, 2) \, 0) * pow(-1 \, _\$0_wtc_harmonic % 4 == 3), f 105;
#X obj 130 1360 list cat;
#X msg 210 1330 clear;
#X obj 100 1470 spigot;
#X obj 100 1600 list prepend;
#X msg 200 1600 sinesum \$1;
#X obj 200 1570 value _\$0_samples;
#X obj 310 950 s \$0-wtc-init-loop;
#X obj 260 1330 r \$0-wtc-init-loop;
#X obj 220 1010 r \$0-wtc-init-loop;
#X obj 200 1540 r \$0-wtc-init-loop;
#X obj 130 1410 trigger a b;
#X obj 160 1440 expr _\$0_wtc_harmonic == _\$0_wtc_n_harmonics;
#X obj 100 1630 list trim 1;
#X obj 410 1690 value _\$0_wavetable;
#X obj 100 1750 send, f 42;
#X msg 410 1719 symbol wavetable\$1;
#X msg 100 1690 normalize;
#X obj 100 1660 trigger b a b, f 42;
#X obj 130 370 expr (_\$0_wavetable * _\$0_octaves * 12) - 1;
#X text 1100 1250 Sine.......: 1st harmonic only (obviously) \, in
phase, f 75;
#X obj 130 1170 select 3 2 1 0;
#X text 880 1200 Sine;
#X obj 210 1200 expr if(_\$0_wtc_harmonic == 1 \, 1 \, 0), f 94;
#X connect 0 0 8 0;
#X connect 1 0 13 0;
#X connect 3 0 4 0;
#X connect 4 0 11 0;
#X connect 6 0 14 0;
#X connect 8 0 9 0;
#X connect 8 1 3 0;
#X connect 9 0 10 0;
#X connect 9 1 67 0;
#X connect 10 0 41 0;
#X connect 10 1 6 0;
#X connect 11 0 5 0;
#X connect 12 0 1 0;
#X connect 13 0 2 0;
#X connect 14 0 7 0;
#X connect 15 0 16 0;
#X connect 16 0 17 0;
#X connect 17 0 18 0;
#X connect 17 0 28 0;
#X connect 18 0 17 1;
#X connect 19 0 17 1;
#X connect 20 0 15 0;
#X connect 20 1 55 0;
#X connect 26 0 69 0;
#X connect 28 0 26 0;
#X connect 28 1 27 0;
#X connect 33 0 49 0;
#X connect 34 0 40 1;
#X connect 35 0 40 0;
#X connect 36 0 40 2;
#X connect 37 0 40 3;
#X connect 38 0 40 4;
#X connect 39 0 35 0;
#X connect 39 1 34 0;
#X connect 39 2 36 0;
#X connect 39 3 37 0;
#X connect 39 4 38 0;
#X connect 40 0 42 0;
#X connect 41 0 20 0;
#X connect 41 1 39 0;
#X connect 45 0 49 0;
#X connect 48 0 49 0;
#X connect 49 0 59 0;
#X connect 50 0 49 1;
#X connect 51 0 52 0;
#X connect 52 0 61 0;
#X connect 53 0 52 1;
#X connect 54 0 53 0;
#X connect 56 0 50 0;
#X connect 57 0 19 0;
#X connect 58 0 54 0;
#X connect 59 0 51 0;
#X connect 59 1 60 0;
#X connect 60 0 51 1;
#X connect 61 0 66 0;
#X connect 62 0 64 0;
#X connect 64 0 63 1;
#X connect 65 0 63 0;
#X connect 66 0 65 0;
#X connect 66 1 63 0;
#X connect 66 2 62 0;
#X connect 67 0 12 0;
#X connect 69 0 48 0;
#X connect 69 1 45 0;
#X connect 69 2 33 0;
#X connect 69 3 71 0;
#X connect 71 0 49 0;
#X restore 1300 451 pd calc-wavetable;
#X obj 900 680 r \$0-wavetable;
#X obj 900 740 value _\$0_wavetable;
#X obj 900 320 r \$0-octaves;
#X obj 930 410 value _\$0_octaves;
#X obj 900 200 r \$0-waveform;
#X obj 900 260 value _\$0_waveform;
#X obj 900 560 r \$0-samples;
#X obj 900 620 value _\$0_samples;
#X text 900 170 ---- Variables ----;
#X text 1300 181 ---- Initialization ----;
#X text 1300 421 ---- Implementations ----;
#X obj 900 500 value _\$0_n_wavetables;
#X floatatom 900 470 5 0 0 0 - - - 0 0 1, f 5;
#X obj 900 350 trigger f f;
#X floatatom 930 380 5 0 0 0 - - - 0 0 1, f 5;
#X floatatom 900 230 5 0 0 0 - - - 0 0 1, f 5;
#X floatatom 900 590 5 0 0 0 - - - 0 0 1, f 5;
#X floatatom 900 710 5 0 0 0 - - - 0 0 1, f 5;
#N canvas 0 49 1920 1009 other-buttons 0;
#X obj 900 110 r \$0-wavetable-clear;
#X obj 1300 410 r \$0-wavetable-save;
#X obj 900 410 r \$0-wavetable-load;
#X obj 900 713 soundfiler;
#X msg 900 683 read -resize \$1 wavetable\$2;
#X obj 900 160 value _\$0_wavetable;
#X text 900 80 Clear Wavetable;
#X text 900 380 Load File into Wavetable;
#X text 1300 380 Save Wavetable into File;
#X obj 980 490 value _\$0_wavetable;
#X obj 900 490 openpanel;
#X obj 900 460 trigger b b;
#X obj 900 520 pack s f;
#X obj 1300 713 soundfiler;
#X obj 1380 490 value _\$0_wavetable;
#X obj 1300 460 trigger b b;
#X obj 1300 520 pack s f;
#X obj 1300 490 savepanel;
#X msg 1300 683 write -wave \$1 wavetable\$2;
#X obj 100 100 r \$0-calc-all;
#X text 100 70 Calculate all wavetables;
#X obj 500 100 r \$0-clear-all;
#X text 500 70 Clear all wavetables;
#X obj 130 400 until;
#X obj 130 430 f;
#X obj 170 430 + 1;
#X obj 130 340 trigger b b;
#X msg 310 370 1;
#X msg 530 290 16;
#X obj 530 320 until;
#X obj 530 350 f;
#X obj 570 350 + 1;
#X obj 530 260 trigger b b;
#X msg 600 290 1;
#X msg 100 560 \; \$0-wavetable 1;
#X msg 500 480 \; \$0-wavetable 1;
#X obj 100 310 trigger b b;
#X obj 500 230 trigger b b;
#X msg 900 270 \; wavetable\$1 const 0;
#X obj 100 150 trigger b b;
#X obj 124 182 print Calculate all wavetables;
#X obj 500 150 trigger b b;
#X obj 526 182 print Clear all wavetables;
#X obj 900 190 trigger f f;
#X obj 930 220 print Clear wavetable;
#X obj 1300 570 trigger a a;
#X obj 900 570 trigger a a;
#X obj 930 630 print Load into Wavetable;
#X obj 1330 630 print Save Wavetable;
#X msg 130 480 \; \$0-wavetable \$1 \; \$0-wavetable-calc bang;
#X msg 530 400 \; \$0-wavetable \$1 \; \$0-wavetable-clear bang;
#X msg 1330 600 \$2 \$1;
#X msg 930 600 \$2 \$1;
#X obj 130 370 value _\$0_n_wavetables;
#X obj 100 230 trigger b b;
#X obj 130 260 s \$0-clear-all;
#X connect 0 0 5 0;
#X connect 1 0 15 0;
#X connect 2 0 11 0;
#X connect 4 0 3 0;
#X connect 5 0 43 0;
#X connect 9 0 12 1;
#X connect 10 0 12 0;
#X connect 11 0 10 0;
#X connect 11 1 9 0;
#X connect 12 0 46 0;
#X connect 14 0 16 1;
#X connect 15 0 17 0;
#X connect 15 1 14 0;
#X connect 16 0 45 0;
#X connect 17 0 16 0;
#X connect 18 0 13 0;
#X connect 19 0 39 0;
#X connect 21 0 41 0;
#X connect 23 0 24 0;
#X connect 24 0 25 0;
#X connect 24 0 49 0;
#X connect 25 0 24 1;
#X connect 26 0 53 0;
#X connect 26 1 27 0;
#X connect 27 0 24 1;
#X connect 28 0 29 0;
#X connect 29 0 30 0;
#X connect 30 0 31 0;
#X connect 30 0 50 0;
#X connect 31 0 30 1;
#X connect 32 0 28 0;
#X connect 32 1 33 0;
#X connect 33 0 30 1;
#X connect 36 0 34 0;
#X connect 36 1 26 0;
#X connect 37 0 35 0;
#X connect 37 1 32 0;
#X connect 39 0 54 0;
#X connect 39 1 40 0;
#X connect 41 0 37 0;
#X connect 41 1 42 0;
#X connect 43 0 38 0;
#X connect 43 1 44 0;
#X connect 45 0 18 0;
#X connect 45 1 51 0;
#X connect 46 0 4 0;
#X connect 46 1 52 0;
#X connect 51 0 48 0;
#X connect 52 0 47 0;
#X connect 53 0 23 0;
#X connect 54 0 36 0;
#X connect 54 1 55 0;
#X restore 1300 481 pd other-buttons;
#X text 340 250 Sawtooth;
#X obj 900 440 expr ceil(float(128) / 12 / _\$0_octaves);
#X msg 1300 270 \; \$0-waveform 0 \; \$0-octaves 1 \; \$0-samples 512
\; \$0-wavetable 1 \;;
#X text 340 230 Sine;
#X connect 6 0 7 0;
#X connect 7 0 1 0;
#X connect 8 0 9 0;
#X connect 9 0 0 0;
#X connect 12 0 13 0;
#X connect 13 0 11 0;
#X connect 17 0 18 0;
#X connect 18 0 48 0;
#X connect 23 0 22 0;
#X connect 25 0 23 0;
#X connect 27 0 44 0;
#X connect 29 0 40 0;
#X connect 31 0 42 0;
#X connect 33 0 43 0;
#X connect 39 0 38 0;
#X connect 40 0 47 0;
#X connect 40 1 41 0;
#X connect 41 0 30 0;
#X connect 42 0 32 0;
#X connect 43 0 34 0;
#X connect 44 0 28 0;
#X connect 47 0 39 0;
#X coords 0 -1 1 1 400 180 2 300 200;
#X restore 100 100 pd ui;
#X text 100 380 Harmonic amplitudes, f 75;
#X text 100 400 ===================, f 75;
#X text 100 490 Square.....: Odd harmonics \, 1/n amplitude \, all
harmonics in phase, f 75;
#X text 100 520 Triangle...: Odd harmonics \, 1/n² amplitude \, every
second 180° out of phase, f 75;
#X text 100 460 Sawtooth...: All harmonics \, 1/n amplitude \, even
harmonics 180° out of phase, f 75;
#X text 100 610 Each wavetable spans whole octaves minus one \, e.g.
C0 - B0. Calculation uses the highest note of the octave whose harmonics
are added up to the nyquist frequency based on PD's current sample
rate., f 75;
#X text 100 430 Sine.......: 1st harmonic only (obviously) \, in phase
, f 75;
